<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "Installation_Guide.ent">
%BOOK_ENTITIES;
]>

<chapter id="chap-troubleshooting-s390">
	<title>Troubleshooting Installation on IBM System&nbsp;z</title>


	<indexterm>
		<primary>troubleshooting</primary>
		<secondary>IBM System z</secondary>
	</indexterm>
	<indexterm>
		<primary>log files</primary>
		<secondary>IBM System z</secondary>
	</indexterm>
	<indexterm>
		<primary>anaconda.log</primary>
		<secondary>IBM System z</secondary>
	</indexterm>
	<indexterm>
		<primary>program.log</primary>
		<secondary>IBM System z</secondary>
	</indexterm>
	<indexterm>
		<primary>storage.log</primary>
		<secondary>IBM System z</secondary>
	</indexterm>
	<indexterm>
		<primary>packaging.log</primary>
		<secondary>IBM System z</secondary>
	</indexterm>
	<indexterm>
		<primary>syslog</primary>
		<secondary>IBM System z</secondary>
	</indexterm>


	<para>
		This chapter discusses some common installation problems and their solutions.
	</para>
	<para>
		For debugging purposes, <application>Anaconda</application> logs installation actions into files in the <filename>/tmp</filename> directory. These files are listed in the following table.
	</para>
	<table id="tabl-installation-log-files-s390">
		<title>Log Files Generated During the Installation</title>
		<tgroup cols="2">
			<colspec colname="c1" colwidth="1*"/>
			<colspec colname="c2" colwidth="2*"/>
			<thead>
				<row>
					<entry>
						Log file
					</entry>
					<entry>
						Contents
					</entry>
				</row>
			</thead>
			<tbody>
				<row>
					<entry>
						<filename>/tmp/anaconda.log</filename>
					</entry>
					<entry>
						general <application>Anaconda</application> messages
					</entry>
				</row>
				<row>
					<entry>
						<filename>/tmp/program.log</filename>
					</entry>
					<entry>
						all external programs run during the installation
					</entry>
				</row>
				<row>
					<entry>
						<filename>/tmp/storage.log</filename>
					</entry>
					<entry>
						extensive storage module information
					</entry>
				</row>
				<row>
					<entry>
						<filename>/tmp/packaging.log</filename>
					</entry>
					<entry>
						<application>yum</application> and <application>rpm</application> package installation messages
					</entry>
				</row>
				<row>
					<entry>
						<filename>/tmp/syslog</filename>
					</entry>
					<entry>
						hardware-related system messages
					</entry>
				</row>
			</tbody>
		</tgroup>
	</table>
	<para>
		If the installation fails, the messages from these files are consolidated into <filename>/tmp/anaconda-tb-<replaceable>identifier</replaceable></filename>, where <replaceable>identifier</replaceable> is a random string.
	</para>
	<para>
		After successful installation, by default, these files will be copied to the installed system under the directory <filename class="directory">/var/log/anaconda/</filename>. However, if installation is unsuccessful, or if the <option>inst.nosave=all</option> or <option>inst.nosave=logs</option> options are used when booting the installation system, these logs will only exist in the installation program's RAM disk. This means they are not saved permanently and will be lost once the system is powered down. To store them permanently, copy those files to another system on the network by using <command>scp</command> on the system running the installation program, or copy them to a mounted storage device (such as an USB flash drive). Details on how to transfer the log files over the network are below.
	</para>
	<note>
		<para>
			The following procedure requires the installation system to be able to access the network and the target system to be able to receive files over the <systemitem class="protocol">ssh</systemitem> protocol.
		</para>
	</note>
	<procedure>
		<title>Transferring Log Files Over the Network</title>
		<step>
			<para>
				Access the shell prompt on the installation system. This can be done in the following ways:
			</para>
			<itemizedlist>
				<listitem>
					<para>
						In a running <systemitem>tmux</systemitem> session on the installation system, press <keycombo><keycap>Ctrl</keycap><keycap>b</keycap></keycombo> <keycap>p</keycap> and <keycombo><keycap>Ctrl</keycap><keycap>b</keycap></keycombo> <keycap>n</keycap> to switch to the previous or next terminal, respectively, and find the terminal with a root shell.
					</para>
				</listitem>
				<listitem>
					<para>
						Connect to the installation system over <systemitem class="protocol">ssh</systemitem>.
					</para>
				</listitem>
			</itemizedlist>
			<para>
				In both cases, you will be able to use the installation system's shell as <systemitem class="username">root</systemitem>.
			</para>
		</step>
		<step>
			<para>
				Switch to the <filename class="directory">/tmp</filename> directory where the log files are located:
			</para>
<screen><prompt>#</prompt> <command>cd /tmp</command></screen>
		</step>
		<step>
			<para>
				Copy the log files onto another system on the network using the <command>scp</command> command:
			</para>
<screen><prompt>#</prompt> <command>scp *log <replaceable>user</replaceable>@<replaceable>address</replaceable>:<replaceable>path</replaceable></command></screen>
			<para>
				Replace <replaceable>user</replaceable> with a valid user name on the target system, <replaceable>address</replaceable> with the target system's address or host name, and <replaceable>path</replaceable> with the path to the directory you want to save the log files into. For example, if you want to log in as <systemitem class="username">john</systemitem> to a system with an IP address of <systemitem>192.168.0.122</systemitem> and place the log files into the <filename class="directory">/home/john/logs/</filename> directory on that system, the command will have the following form:
			</para>
<screen><prompt>#</prompt> <command>scp *log john@192.168.0.122:/home/john/logs/</command></screen>
			<para>
				When connecting to the target system for the first time, the SSH client asks you to confirm that the fingerprint of the remote system is correct and that you want to continue:
			</para>
<screen>
<computeroutput>The authenticity of host '192.168.0.122 (192.168.0.122)' can't be established.</computeroutput>
<computeroutput>ECDSA key fingerprint is a4:60:76:eb:b2:d0:aa:23:af:3d:59:5c:de:bb:c4:42.</computeroutput>
<computeroutput>Are you sure you want to continue connecting (yes/no)?</computeroutput>
</screen>
			<para>
				Type <literal>yes</literal> and press <keycap>Enter</keycap> to continue. Then, provide a valid password when prompted. The files will start transferring to the specified directory on the target system.
			</para>
		</step>
	</procedure>
	<para>
		The log files from the installation are now permanently saved on the target system and available for review.
	</para>

	<section id="sect-trouble-during-installation-s390">
		<title>Trouble During the Installation</title>


		<indexterm>
			<primary>troubleshooting</primary>
			<secondary>during the installation</secondary>
			<tertiary>IBM System z</tertiary>
		</indexterm>


		<section id="sect-trouble-during-no-target-s390">
			<title>No Disks Detected</title>


			<indexterm>
				<primary>troubleshooting</primary>
				<secondary>no disks detected</secondary>
				<tertiary>IBM System z</tertiary>
			</indexterm>


			<para>
				In the <guilabel>Installation Destination</guilabel> screen, the following error message can appear at the bottom: <guilabel>No disks detected. Please shut down the computer, connect at least one disk, and restart to complete installation</guilabel>.
			</para>
			<para>
				This message usually indicates that there is an issue with your DASD (<firstterm>Direct Access Storage Device</firstterm>) devices. If you encounter this error, add the <command>DASD=&lt;<replaceable>disks</replaceable>&gt;</command> parameter to your parameter file or CMS configuration file (where <replaceable>disks</replaceable> is the DASD range reserved for installation) and start the installation again.
			</para>
			<para>
				Additionally, make sure you format the DASDs using the <command>dasdfmt</command> command within a Linux root shell, instead of formatting the DASDs using CMS. <application>Anaconda</application> automatically detects any DASD devices that are not yet formatted and asks you whether to format the devices.
			</para>
			<para>
				If you are installing into one or more iSCSI devices and there is no local storage present on the system, make sure that all required LUNs (<firstterm>Logical Unit Numbers</firstterm>) are being presented to the appropriate HBA (<firstterm>Host Bus Adapter</firstterm>). For additional information about iSCSI, see <xref linkend="appe-iscsi-disks"/>.
			</para>
		</section>



		<section id="sect-trouble-during-traceback-s390">
			<title>Reporting Traceback Messages</title>


			<indexterm>
				<primary>troubleshooting</primary>
				<secondary>saving traceback messages without removable media</secondary>
				<tertiary>IBM System&nbsp;z</tertiary>
			</indexterm>
			<indexterm>
				<primary>traceback messages</primary>
				<secondary>saving traceback messages without removable media</secondary>
				<tertiary>IBM System&nbsp;z</tertiary>
			</indexterm>


			<para>
				If the graphical installation program encounters an error, it presents you with a crash reporting dialog box. You can then choose to send information about the problem you encountered to Red&nbsp;Hat. To send a crash report, you will need to enter your Customer Portal credentials. If you do not have a Customer Portal account, you can register at <ulink url="https://www.redhat.com/wapps/ugc/register.html"/>. Automated crash reporting also requires a working network connection.
			</para>
			<figure>
				<title>The Crash Reporting Dialog Box</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/crashreporting/crashreporting.png" format="PNG"/>
					</imageobject>
					<textobject>
						<para>
							A message saying that an unknown error has occurred.
						</para>
					</textobject>
				</mediaobject>
			</figure>
			<para>
				When the dialog appears, select <guibutton>Report Bug</guibutton> to report the problem, or <guibutton>Quit</guibutton> to exit the installation.
			</para>
			<para>
				Optionally, click <guilabel>More Info</guilabel> to display detailed output that can help determine the cause of the error. If you are familiar with debugging, click <guibutton>Debug</guibutton>. This will take you to virtual terminal <systemitem>tty1</systemitem>, where you can request more precise information that will enhance the bug report. To return to the graphical interface from <systemitem>tty1</systemitem>, use the <command>continue</command> command.
			</para>
			<figure>
				<title>The Expanded Crash Reporting Dialog Box</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="images/crashreporting/crashreporting_details.png" format="PNG"/>
					</imageobject>
					<textobject>
						<para>
							Details of the crash, showing the Python traceback
						</para>
					</textobject>
				</mediaobject>
			</figure>
			<para>
				If you want to report the bug to the customer portal, follow the procedure below.
			</para>
			<procedure>
				<title>Reporting Errors to Red&nbsp;Hat Customer Support</title>
				<step>
					<para>
						In the menu that appears, select <guilabel>Report a bug to Red&nbsp;Hat Customer Portal</guilabel>.
					</para>
				</step>
				<step>
					<para>
						To report the bug to Red&nbsp;Hat, you first need to provide your Customer Portal credentials. Click <guibutton>Configure Red&nbsp;Hat Customer Support</guibutton>.
					</para>
					<figure>
						<title>Customer Portal Credentials</title>
						<mediaobject>
							<imageobject>
								<imagedata fileref="images/crashreporting/crashreporting_configure1.png" format="PNG"/>
							</imageobject>
							<textobject>
								<para>
									A message saying that the Red&nbsp;Hat Customer Support is not properly configured, with a button you can click to configure your credentials.
								</para>
							</textobject>
						</mediaobject>
					</figure>
				</step>
				<step>
					<para>
						A new window is now open, prompting you to enter your Customer Portal user name and password. Enter your Red&nbsp;Hat Customer Portal credentials.
					</para>
					<figure>
						<title>Configure Red&nbsp;Hat Customer Support</title>
						<mediaobject>
							<imageobject>
								<imagedata fileref="images/crashreporting/crashreporting_configure2.png" format="PNG"/>
							</imageobject>
							<textobject>
								<para>
									A dialog prompting you to enter your Customer Portal account details.
								</para>
							</textobject>
						</mediaobject>
					</figure>
					<para>
						If your network settings require you to use a <systemitem class="protocol">HTTP</systemitem> or <systemitem class="protocol">HTTPS</systemitem> proxy, you can configure it by expanding the <guilabel>Advanced</guilabel> menu and entering the address of the proxy server.
					</para>
					<para>
						When you put in all required credentials, click <guilabel>OK</guilabel> to proceed.
					</para>
				</step>
				<step>
					<para>
						A new window appears, containing a text field. Write down any useful information and comments here. Describe how the error can be reproduced by explaining each step you took before the crash reporting dialog appeared. Provide as much relevant detail as possible, including any information you acquired when debugging. Be aware that the information you provide here can become publicly visible on the Customer Portal.
					</para>
					<para>
						If you do not know what caused the error, check the box labeled <guilabel>I don't know what caused this problem</guilabel> at the bottom of the dialog.
					</para>
					<para>
						Then, click <guibutton>Forward</guibutton>.
					</para>
					<figure>
						<title>Describe the Problem</title>
						<mediaobject>
							<imageobject>
								<imagedata fileref="images/crashreporting/crashreporting_describe.png" format="PNG"/>
							</imageobject>
							<textobject>
								<para>
									A text input field, prompting you to describe the steps you took before you encountered the error you are reporting.
								</para>
							</textobject>
						</mediaobject>
					</figure>
				</step>
				<step>
					<para>
						Next, review the information that will be sent to the Customer Portal. The explanation you provided is in the <guilabel>comment</guilabel> tab. Other tabs include such information as your system's host name and other details about the installation environment. You can remove any items you do not want sent to Red&nbsp;Hat, but be aware that providing less detail can affect the investigation of the issue.
					</para>
					<para>
						Click <guibutton>Forward</guibutton> when you finish reviewing the information to be sent.
					</para>
					<figure>
						<title>Review the Data to Be Sent</title>
						<mediaobject>
							<imageobject>
								<imagedata fileref="images/crashreporting/crashreporting_review.png" format="PNG"/>
							</imageobject>
							<textobject>
								<para>
									A dialog window with several tabs, allowing you to review all information about your system that will be sent to the Customer Portal as part of the crash report.
								</para>
							</textobject>
						</mediaobject>
					</figure>
				</step>
				<step>
					<para>
						Review the list of files that will be sent and included in the bug report as individual attachments. These files provide system information that will assist the investigation. If you do not want to send certain files, uncheck the box next to each one. To provide additional files that can help find the problem, click <guibutton>Attach a file</guibutton>.
					</para>
					<para>
						Once you have reviewed the files to be sent, check the box labeled <guilabel>I have reviewed the data and agree with submitting it</guilabel>. Then, click <guibutton>Forward</guibutton> to send the report and attachments to the Customer Portal.
					</para>
					<figure>
						<title>Review the Files to Be Sent</title>
						<mediaobject>
							<imageobject>
								<imagedata fileref="images/crashreporting/crashreporting_checkfiles.png" format="PNG"/>
							</imageobject>
							<textobject>
								<para>
									A dialog window allowing you to review the files to be sent along with the report, unselect files you do not want to send, and add additional files..
								</para>
							</textobject>
						</mediaobject>
					</figure>
				</step>
				<step>
					<para>
						When the dialog reports that processing has finished, you can click <guilabel>Show log</guilabel> to view details of the reporting process or <guilabel>Close</guilabel> to return to the initial crash reporting dialog box. There, click <guilabel>Quit</guilabel> to exit the installation.
					</para>
				</step>
			</procedure>
		</section>

		<section id="creating_pre-installation-logs-s390">
			<title>Creating Pre-installation Log Files</title>
			<para>
				To debug installation problems you can set the <option>inst.debug</option> option to create log files from the environment before the installation starts. These log files contain, for example, the current storage configuration.
			</para>
			<para>
				To set the option in the &PRODUCT; installation boot menu:
			</para>
			<procedure>
				<step>
					<para>
						Select the <guimenuitem>Install &PRODUCT; 7.3</guimenuitem> entry.
					</para>
				</step>
				<step>
					<para>
						Press the <keycap>Tab</keycap> key to edit the boot options.
					</para>
				</step>
				<step>
					<para>
						Append <option>inst.debug</option> to the options. For example:
					</para>
<screen>&gt; vmlinuz ... <userinput>inst.debug</userinput></screen>
					<para>
						For further details, see <xref linkend="chap-anaconda-boot-options"/>.
					</para>
				</step>
				<step>
					<para>
						Press <keycap>Enter</keycap> to start the setup.
					</para>
				</step>
			</procedure>
			<para>
				The system stores the pre-installation log files in the <filename class="directory">/tmp/pre-anaconda-logs/</filename> directory before Anaconda starts. To access the log files:
			</para>
			<procedure>
				<step>
					<para>
						Switch to the console. See <xref linkend="sect-installation-consoles-x86"/>.
					</para>
				</step>
				<step>
					<para>
						Change into the <filename class="directory">/tmp/pre-anaconda-logs/</filename> directory:
					</para>
<screen># cd /tmp/pre-anaconda-logs/</screen>
				</step>
			</procedure>
		</section>

	</section>

	<section id="sect-trouble-after-s390">
		<title>Problems After Installation</title>


		<indexterm>
			<primary>troubleshooting</primary>
			<secondary>after the installation</secondary>
			<tertiary>IBM System z</tertiary>
		</indexterm>


		<section>
			<title>Remote Graphical Desktops and XDMCP</title>


			<indexterm>
				<primary>troubleshooting</primary>
				<secondary>graphical login</secondary>
				<tertiary>IBM System z</tertiary>
			</indexterm>
			<indexterm>
				<primary>troubleshooting</primary>
				<secondary>remote desktop</secondary>
				<tertiary>IBM System z</tertiary>
			</indexterm>
			<indexterm>
				<primary>XDMCP</primary>
				<secondary>enabling</secondary>
				<tertiary>IBM System z</tertiary>
			</indexterm>


			<para>
				If you have installed the <application>X Window System</application> and would like to log in to your &PRODUCT; system using a graphical login manager, enable the <firstterm>X Display Manager Control Protocol</firstterm> (XDMCP). This protocol allows users to remotely log in to a desktop environment from any X-compatible client, such as a network-connected workstation or X11 terminal. The procedure below explains how to enable XDMCP.
			</para>
			<procedure id="proc-trouble-after-enable-xdmcp-s390">
				<title>Enabling XDMCP on IBM System&nbsp;z</title>
				<step>
					<para>
						Open the <filename>/etc/gdm/custom.conf</filename> configuration file in a plain text editor such as <application>vi</application> or <application>nano</application>.
					</para>
				</step>
				<step>
					<para>
						In the <filename>custom.conf</filename> file, locate the section starting with <literal>[xdmcp]</literal>. In this section, add the following line:
					</para>
<screen><literal>Enable=true</literal></screen>
				</step>
				<step>
					<para>
						Save the file, and exit the text editor.
					</para>
				</step>
				<step>
					<para>
						Restart the <application>X Window System</application>. To do this, either reboot the whole system, or restart the <application>GNOME Display Manager</application> using the following command as <systemitem>root</systemitem>:
					</para>
<screen><prompt>#</prompt> <command>systemctl restart gdm.service</command></screen>
					<para>
						Wait for the login prompt to appear again, and log in using your normal user name and password.
					</para>
				</step>
			</procedure>
			<para>
				The System&nbsp;z server is now configured for XDMCP. You can connect to it from another workstation (client) by starting a remote <application>X</application> session using the <command>X</command> command on the client workstation. For example:
			</para>
<screen><prompt>$</prompt> <command>X :1 -query <replaceable>address</replaceable></command></screen>
			<para>
				Replace <replaceable>address</replaceable> with the host name of the remote X11 server. The command connects to the remote X11 server using XDMCP and displays the remote graphical login screen on display <literal>:1</literal> of the X11 server system (usually accessible by pressing <keycap>Ctrl</keycap>-<keycap>Alt</keycap>-<keycap>F8</keycap>).
			</para>
			<para>
				You can also access remote desktop sessions using a <firstterm>nested</firstterm> X11 server, which opens the remote desktop as a window in your current X11 session. <command>Xnest</command> allows users to open a remote desktop nested within their local X11 session. For example, run <command>Xnest</command> using the following command, replacing <replaceable>address</replaceable> with the host name of the remote X11 server:
			</para>
<screen><prompt>$</prompt> <command>Xnest :1 -query <replaceable>address</replaceable></command></screen>
			<para>
				For more information about XDMCP, see the <application>X Window System</application> documentation at <ulink url="http://www.x.org/releases/X11R7.6/doc/libXdmcp/xdmcp.html"/>.
			</para>
		</section>

		<section>
			<title>Is Your System Displaying Signal 11 Errors?</title>


			<indexterm>
				<primary>troubleshooting</primary>
				<secondary>signal 11 error</secondary>
				<tertiary>IBM System z</tertiary>
			</indexterm>


			<para>
				A signal 11 error, commonly known as a <firstterm>segmentation fault</firstterm>, means that a program accessed a memory location that was not assigned to it. A signal 11 error can occur due to a bug in one of the software programs that is installed, or faulty hardware.
			</para>
			<para>
				If you receive a fatal signal 11 error during the installation, first make sure you are using the most recent installation images, and let <application>Anaconda</application> verify them to make sure they are not corrupted. Bad installation media (such as an improperly burned or scratched optical disk) are a common cause of signal 11 errors. Verifying the integrity of the installation media is recommended before every installation.
			</para>
			<para>
				For information about obtaining the most recent installation media, see <xref linkend="chap-download-red-hat-enterprise-linux"/>. To perform a media check before the installation starts, append the <option>rd.live.check</option> boot option at the boot menu. See <xref linkend="sect-boot-options-mediacheck"/> for details.
			</para>
			<para>
				Other possible causes are beyond this document's scope. Consult your hardware manufacturer's documentation for more information.
			</para>
		</section>

	</section>

</chapter>
